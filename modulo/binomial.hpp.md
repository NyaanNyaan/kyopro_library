---
data:
  _extendedDependsOn: []
  _extendedRequiredBy:
  - icon: ':heavy_check_mark:'
    path: fps/find-p-recursive.hpp
    title: "P-recursive\u306E\u9AD8\u901F\u8A08\u7B97"
  - icon: ':heavy_check_mark:'
    path: fps/fps-composition.hpp
    title: "\u95A2\u6570\u306E\u5408\u6210( $\\mathrm{O}\\left((N \\log N)^{\\frac{3}{2}}\\\
      right)$ )"
  - icon: ':heavy_check_mark:'
    path: fps/fps-famous-series.hpp
    title: "\u6709\u540D\u306A\u6570\u5217"
  - icon: ':heavy_check_mark:'
    path: fps/lagrange-interpolation-point.hpp
    title: fps/lagrange-interpolation-point.hpp
  - icon: ':heavy_check_mark:'
    path: fps/partial-fraction-decomposition.hpp
    title: "\u90E8\u5206\u5206\u6570\u5206\u89E3(\u5206\u6BCD\u304C1\u6B21\u5F0F\u306E\
      \u7A4D\u3067\u8868\u305B\u308B\u5834\u5408)"
  - icon: ':heavy_check_mark:'
    path: fps/sample-point-shift.hpp
    title: fps/sample-point-shift.hpp
  - icon: ':heavy_check_mark:'
    path: fps/sum-of-exponential-times-poly.hpp
    title: $\sum_{i}a^i f(i)$
  - icon: ':heavy_check_mark:'
    path: fps/taylor-shift.hpp
    title: "\u5E73\u884C\u79FB\u52D5"
  - icon: ':heavy_check_mark:'
    path: fps/utility.hpp
    title: fps/utility.hpp
  - icon: ':heavy_check_mark:'
    path: matrix/polynomial-matrix-prefix-prod.hpp
    title: "\u591A\u9805\u5F0F\u884C\u5217\u306Eprefix product"
  - icon: ':heavy_check_mark:'
    path: modulo/factorial.hpp
    title: "\u968E\u4E57 $\\mod p$"
  - icon: ':heavy_check_mark:'
    path: modulo/multipoint-binomial-sum.hpp
    title: "\u4E8C\u9805\u4FC2\u6570\u306Eprefix sum\u306E\u591A\u70B9\u8A55\u4FA1"
  _extendedVerifiedWith:
  - icon: ':heavy_check_mark:'
    path: verify/verify-unit-test/dual-fps.test.cpp
    title: verify/verify-unit-test/dual-fps.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-unit-test/multipoint-binomial-sum.test.cpp
    title: verify/verify-unit-test/multipoint-binomial-sum.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-unit-test/p-recursive.test.cpp
    title: verify/verify-unit-test/p-recursive.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-unit-test/partial-fraction-decomposition.test.cpp
    title: verify/verify-unit-test/partial-fraction-decomposition.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-unit-test/polynomial-matrix-prod.test.cpp
    title: verify/verify-unit-test/polynomial-matrix-prod.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-unit-test/sum-of-mf.test.cpp
    title: verify/verify-unit-test/sum-of-mf.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-ds/yosupo-vertex-set-path-composite.test.cpp
    title: verify/verify-yosupo-ds/yosupo-vertex-set-path-composite.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-composition.test.cpp
    title: verify/verify-yosupo-fps/yosupo-composition.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-division-of-polynomials.test.cpp
    title: verify/verify-yosupo-fps/yosupo-division-of-polynomials.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-multieval-fast.test.cpp
    title: verify/verify-yosupo-fps/yosupo-multieval-fast.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-sample-point-shift.test.cpp
    title: verify/verify-yosupo-fps/yosupo-sample-point-shift.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-stirling-1st.test.cpp
    title: verify/verify-yosupo-fps/yosupo-stirling-1st.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-sum-of-exp-poly-limit.test.cpp
    title: verify/verify-yosupo-fps/yosupo-sum-of-exp-poly-limit.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-sum-of-exp-poly.test.cpp
    title: verify/verify-yosupo-fps/yosupo-sum-of-exp-poly.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-fps/yosupo-taylor-shift.test.cpp
    title: verify/verify-yosupo-fps/yosupo-taylor-shift.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-math/yosupo-determinant-of-sparse-matrix-bbla.test.cpp
    title: verify/verify-yosupo-math/yosupo-determinant-of-sparse-matrix-bbla.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-math/yosupo-sum-of-totient-2.test.cpp
    title: verify/verify-yosupo-math/yosupo-sum-of-totient-2.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yosupo-ntt/yosupo-convolution-large.test.cpp
    title: verify/verify-yosupo-ntt/yosupo-convolution-large.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-0117.test.cpp
    title: verify/verify-yuki/yuki-0117.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-0125.test.cpp
    title: verify/verify-yuki/yuki-0125.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-0502.test.cpp
    title: verify/verify-yuki/yuki-0502.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-0720.test.cpp
    title: verify/verify-yuki/yuki-0720.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-0890.test.cpp
    title: verify/verify-yuki/yuki-0890.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-0963-circular.test.cpp
    title: verify/verify-yuki/yuki-0963-circular.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1080.test.cpp
    title: verify/verify-yuki/yuki-1080.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1112-sparse.test.cpp
    title: verify/verify-yuki/yuki-1112-sparse.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1112.test.cpp
    title: verify/verify-yuki/yuki-1112.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1145-frac.test.cpp
    title: verify/verify-yuki/yuki-1145-frac.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1145.test.cpp
    title: verify/verify-yuki/yuki-1145.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1303.test.cpp
    title: verify/verify-yuki/yuki-1303.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1504.test.cpp
    title: verify/verify-yuki/yuki-1504.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1510.test.cpp
    title: verify/verify-yuki/yuki-1510.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1533.test.cpp
    title: verify/verify-yuki/yuki-1533.test.cpp
  - icon: ':heavy_check_mark:'
    path: verify/verify-yuki/yuki-1781.test.cpp
    title: verify/verify-yuki/yuki-1781.test.cpp
  _isVerificationFailed: false
  _pathExtension: hpp
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    links: []
  bundledCode: "#line 2 \"modulo/binomial.hpp\"\n\ntemplate <typename T>\nstruct Binomial\
    \ {\n  vector<T> f, g, h;\n  Binomial(int MAX = 0) : f(1, T(1)), g(1, T(1)), h(1,\
    \ T(1)) {\n    while (MAX >= (int)f.size()) extend();\n  }\n\n  void extend()\
    \ {\n    int n = f.size();\n    int m = n * 2;\n    f.resize(m);\n    g.resize(m);\n\
    \    h.resize(m);\n    for (int i = n; i < m; i++) f[i] = f[i - 1] * T(i);\n \
    \   g[m - 1] = f[m - 1].inverse();\n    h[m - 1] = g[m - 1] * f[m - 2];\n    for\
    \ (int i = m - 2; i >= n; i--) {\n      g[i] = g[i + 1] * T(i + 1);\n      h[i]\
    \ = g[i] * f[i - 1];\n    }\n  }\n\n  T fac(int i) {\n    if (i < 0) return T(0);\n\
    \    while (i >= (int)f.size()) extend();\n    return f[i];\n  }\n\n  T finv(int\
    \ i) {\n    if (i < 0) return T(0);\n    while (i >= (int)g.size()) extend();\n\
    \    return g[i];\n  }\n\n  T inv(int i) {\n    if (i < 0) return -inv(-i);\n\
    \    while (i >= (int)h.size()) extend();\n    return h[i];\n  }\n\n  T C(int\
    \ n, int r) {\n    if (n < 0 || n < r || r < 0) return T(0);\n    return fac(n)\
    \ * finv(n - r) * finv(r);\n  }\n\n  inline T operator()(int n, int r) { return\
    \ C(n, r); }\n\n  template <typename I>\n  T multinomial(const vector<I>& r) {\n\
    \    static_assert(is_integral<I>::value == true);\n    int n = 0;\n    for (auto&\
    \ x : r) {\n      if(x < 0) return T(0);\n      n += x;\n    }\n    T res = fac(n);\n\
    \    for (auto& x : r) res *= finv(x);\n    return res;\n  }\n\n  template <typename\
    \ I>\n  T operator()(const vector<I>& r) {\n    return multinomial(r);\n  }\n\n\
    \  T C_naive(int n, int r) {\n    if (n < 0 || n < r || r < 0) return T(0);\n\
    \    T ret = T(1);\n    r = min(r, n - r);\n    for (int i = 1; i <= r; ++i) ret\
    \ *= inv(i) * (n--);\n    return ret;\n  }\n\n  T P(int n, int r) {\n    if (n\
    \ < 0 || n < r || r < 0) return T(0);\n    return fac(n) * finv(n - r);\n  }\n\
    \n  T H(int n, int r) {\n    if (n < 0 || r < 0) return T(0);\n    return r ==\
    \ 0 ? 1 : C(n + r - 1, r);\n  }\n};\n"
  code: "#pragma once\n\ntemplate <typename T>\nstruct Binomial {\n  vector<T> f,\
    \ g, h;\n  Binomial(int MAX = 0) : f(1, T(1)), g(1, T(1)), h(1, T(1)) {\n    while\
    \ (MAX >= (int)f.size()) extend();\n  }\n\n  void extend() {\n    int n = f.size();\n\
    \    int m = n * 2;\n    f.resize(m);\n    g.resize(m);\n    h.resize(m);\n  \
    \  for (int i = n; i < m; i++) f[i] = f[i - 1] * T(i);\n    g[m - 1] = f[m - 1].inverse();\n\
    \    h[m - 1] = g[m - 1] * f[m - 2];\n    for (int i = m - 2; i >= n; i--) {\n\
    \      g[i] = g[i + 1] * T(i + 1);\n      h[i] = g[i] * f[i - 1];\n    }\n  }\n\
    \n  T fac(int i) {\n    if (i < 0) return T(0);\n    while (i >= (int)f.size())\
    \ extend();\n    return f[i];\n  }\n\n  T finv(int i) {\n    if (i < 0) return\
    \ T(0);\n    while (i >= (int)g.size()) extend();\n    return g[i];\n  }\n\n \
    \ T inv(int i) {\n    if (i < 0) return -inv(-i);\n    while (i >= (int)h.size())\
    \ extend();\n    return h[i];\n  }\n\n  T C(int n, int r) {\n    if (n < 0 ||\
    \ n < r || r < 0) return T(0);\n    return fac(n) * finv(n - r) * finv(r);\n \
    \ }\n\n  inline T operator()(int n, int r) { return C(n, r); }\n\n  template <typename\
    \ I>\n  T multinomial(const vector<I>& r) {\n    static_assert(is_integral<I>::value\
    \ == true);\n    int n = 0;\n    for (auto& x : r) {\n      if(x < 0) return T(0);\n\
    \      n += x;\n    }\n    T res = fac(n);\n    for (auto& x : r) res *= finv(x);\n\
    \    return res;\n  }\n\n  template <typename I>\n  T operator()(const vector<I>&\
    \ r) {\n    return multinomial(r);\n  }\n\n  T C_naive(int n, int r) {\n    if\
    \ (n < 0 || n < r || r < 0) return T(0);\n    T ret = T(1);\n    r = min(r, n\
    \ - r);\n    for (int i = 1; i <= r; ++i) ret *= inv(i) * (n--);\n    return ret;\n\
    \  }\n\n  T P(int n, int r) {\n    if (n < 0 || n < r || r < 0) return T(0);\n\
    \    return fac(n) * finv(n - r);\n  }\n\n  T H(int n, int r) {\n    if (n < 0\
    \ || r < 0) return T(0);\n    return r == 0 ? 1 : C(n + r - 1, r);\n  }\n};\n"
  dependsOn: []
  isVerificationFile: false
  path: modulo/binomial.hpp
  requiredBy:
  - modulo/multipoint-binomial-sum.hpp
  - modulo/factorial.hpp
  - matrix/polynomial-matrix-prefix-prod.hpp
  - fps/taylor-shift.hpp
  - fps/partial-fraction-decomposition.hpp
  - fps/sample-point-shift.hpp
  - fps/fps-famous-series.hpp
  - fps/lagrange-interpolation-point.hpp
  - fps/utility.hpp
  - fps/fps-composition.hpp
  - fps/sum-of-exponential-times-poly.hpp
  - fps/find-p-recursive.hpp
  timestamp: '2021-08-10 23:14:36+09:00'
  verificationStatus: LIBRARY_ALL_AC
  verifiedWith:
  - verify/verify-yosupo-ntt/yosupo-convolution-large.test.cpp
  - verify/verify-yosupo-fps/yosupo-sum-of-exp-poly.test.cpp
  - verify/verify-yosupo-fps/yosupo-taylor-shift.test.cpp
  - verify/verify-yosupo-fps/yosupo-stirling-1st.test.cpp
  - verify/verify-yosupo-fps/yosupo-division-of-polynomials.test.cpp
  - verify/verify-yosupo-fps/yosupo-sum-of-exp-poly-limit.test.cpp
  - verify/verify-yosupo-fps/yosupo-composition.test.cpp
  - verify/verify-yosupo-fps/yosupo-sample-point-shift.test.cpp
  - verify/verify-yosupo-fps/yosupo-multieval-fast.test.cpp
  - verify/verify-yosupo-ds/yosupo-vertex-set-path-composite.test.cpp
  - verify/verify-unit-test/multipoint-binomial-sum.test.cpp
  - verify/verify-unit-test/partial-fraction-decomposition.test.cpp
  - verify/verify-unit-test/dual-fps.test.cpp
  - verify/verify-unit-test/polynomial-matrix-prod.test.cpp
  - verify/verify-unit-test/p-recursive.test.cpp
  - verify/verify-unit-test/sum-of-mf.test.cpp
  - verify/verify-yosupo-math/yosupo-determinant-of-sparse-matrix-bbla.test.cpp
  - verify/verify-yosupo-math/yosupo-sum-of-totient-2.test.cpp
  - verify/verify-yuki/yuki-0963-circular.test.cpp
  - verify/verify-yuki/yuki-1781.test.cpp
  - verify/verify-yuki/yuki-0502.test.cpp
  - verify/verify-yuki/yuki-1504.test.cpp
  - verify/verify-yuki/yuki-1080.test.cpp
  - verify/verify-yuki/yuki-1533.test.cpp
  - verify/verify-yuki/yuki-0890.test.cpp
  - verify/verify-yuki/yuki-1303.test.cpp
  - verify/verify-yuki/yuki-1112.test.cpp
  - verify/verify-yuki/yuki-0117.test.cpp
  - verify/verify-yuki/yuki-1145-frac.test.cpp
  - verify/verify-yuki/yuki-1510.test.cpp
  - verify/verify-yuki/yuki-1145.test.cpp
  - verify/verify-yuki/yuki-1112-sparse.test.cpp
  - verify/verify-yuki/yuki-0125.test.cpp
  - verify/verify-yuki/yuki-0720.test.cpp
documentation_of: modulo/binomial.hpp
layout: document
redirect_from:
- /library/modulo/binomial.hpp
- /library/modulo/binomial.hpp.html
title: modulo/binomial.hpp
---
