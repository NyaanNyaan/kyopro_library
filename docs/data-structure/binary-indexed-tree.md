## Binary Indexed Tree

#### 概要

Binary Indexed Tree(BIT, Fenwick Treeとも)とは、要素数$n$の数列に対して、値の一点加算と区間和の取得を$\mathrm{O}(\log n)$で行うことが出来るデータ構造である。実装がシンプルで定数倍が非常に軽い一方、Segment Treeと異なり逆元が存在しないと区間和が求められないという欠点もある。

また、imos法と併用することで区間加算と一点取得を$\mathrm{O}(\log N)$で行うこともできる。(実はimos法を使用しなくても実装を少し書き換えれば区間加算・一点取得BITは実現できるがここでは実装していない。)

#### 使い方

- `BinaryIndexedTree<T>(size)`: 要素数$size+1$のBITを作成する。
- `add(k, x)`: k番目の要素にxを加算する。
- `operator[](k)`: k番目の要素を取得する。
- `sum(k)`: 区間`[0, k]`の和を取得する。(閉区間に注意)
- `sum(l, r)`: 区間`[l, r]`の和を取得する。(閉区間に注意)
- `imos(l, r, k)`: imos法を利用するとき、`[l, r]`にkを加算する。(この時、一点取得は`sum(k)`で行う。)
- `lower_bound(w)`: 要素が全て非負の時、`[0, k]`の区間和がw以上となるような最小のkを求める。
- `upper_bound(w)`: 要素が全て非負の時、`[0, k]`の区間和がwよりも大きくなるような最小のkを求める。
